<p-growl [(value)]="msgs"></p-growl>
<div class="ikms-body">
	<p-breadcrumb [model]="items"></p-breadcrumb>
	<hr class="small-hr"/>
	<div class="row">
		<div class="col-md-12" >
			<div class="content-section implementation text-center" *ngIf="isLoading">
				<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
			</div>
			<form novalidate
				  #childForm="ngForm">
				<div class="content-section implementation" *ngIf="!isLoading">
					<div class="ui-g form-blue">

						<div class="ui-g-6 ui-sm-12">

						<div class="ui-g-12">
							<div class="ui-g-4 ">Choroby:</div>
							<div class="ui-g-8 ">
									<textarea
											pInputTextarea [rows]="3" [cols]="20"
											[(ngModel)]="child.diseases"
											placeholder="-" class="detail-view-input long-text"
											maxlength="300"
											pattern="[a-zA-ZęóąśłżźćńĘÓĄŚŁŻŹĆŃ\-\ \,\:]*"
											name="diseases" #diseases="ngModel"></textarea>
							</div>
						</div>

						<div class="ui-g-12">
							<div class="ui-g-4 ">Stopień niepełnosprawności:<span class="red">*</span></div>
							<div class="ui-g-8 ">
								<p-dropdown
										[options]="disabilityLevels" [autoWidth]="false"
										required
										[(ngModel)]="child.disabilityLevel" name="disabilityLevel"
										#disabilityLevel></p-dropdown>
							</div>
						</div>

					</div>
					<div class="ui-g-6 ui-sm-12">

						<div class="ui-g-12">
							<div class="ui-g-4 ">Alergie:</div>
							<div class="ui-g-8 ">
									<textarea
											pInputTextarea [rows]="3" [cols]="20"
											placeholder="-" class="detail-view-input long-text"
											[(ngModel)]="child.allergies" maxlength="300"
											pattern="[a-zA-ZęóąśłżźćńĘÓĄŚŁŻŹĆŃ\-\ \,\:]*"
											name="allergies" #allergies="ngModel" ></textarea>
							</div>
						</div>

						<div class="ui-g-12">
							<div class="ui-g-4 ">Rodzic:<span class="red">*</span></div>
							<div class="ui-g-8 ">
								<p-dropdown
										[options]="parents" [autoWidth]="false"
										required placeholder="Wybierz rodzica"
										[(ngModel)]="child.parent.id" name="parent"
										#parent></p-dropdown>
							</div>
						</div>
					</div>
					</div>
				</div>
			</form>

			<hr/>
			<form novalidate
				  #personalDataForm="ngForm">
				<div class="ui-g form-blue" *ngIf="!isLoading">
					<div class="ui-g-6 ui-sm-12">
						<div class="ui-g-12">
							<div class="ui-g-4 ">Imię:<span class="red">*</span></div>
							<div class="ui-g-8 ">
								<input type="text" pInputText
									   placeholder="-" class="detail-view-input"
									   required maxlength="25"
									   pattern="[a-zA-ZęóąśłżźćńĘÓĄŚŁŻŹĆŃ]*"
									   [(ngModel)]="personalData.name"
									   name="name" #firstName = "ngModel" >
								<div class="ui-g-12 validation-err" *ngIf="firstName.touched && firstName.errors?.required">
									Pole nie może być puste
								</div>
								<div class="ui-g-12 validation-err" *ngIf="firstName.errors?.pattern">
									Pole nie może zawierać cyfr i znaków białych.
								</div>
							</div>
						</div>

						<div class="ui-g-12">
							<div class="ui-g-4 ">Drugie imię:</div>
							<div class="ui-g-8 ">
								<input type="text" pInputText
									   placeholder="-" class="detail-view-input"
									   maxlength="25" pattern="[a-zA-ZęóąśłżźćńĘÓĄŚŁŻŹĆŃ]*"
									   [(ngModel)]="personalData.secondaryName"
									   name="secondaryName" #secondaryName = "ngModel">
								<div class="ui-g-12 validation-err" *ngIf="secondaryName.errors?.pattern">
									Pole nie może zawierać cyfr i znaków białych.
								</div>
							</div>
						</div>

						<div class="ui-g-12">
							<div class="ui-g-4 ">Data urodzenia:<span class="red">*</span></div>
							<div class="ui-g-8 ">
								<p-calendar [dataType]="string"
											[monthNavigator]="true" [yearNavigator]="true"
											yearRange="1900:2020" (onSelect)="onDateSelected($event)"
											required inputStyleClass="detail-view-input"
											[(ngModel)]="personalData.dateOfBirth"
											[maxDate]="maxDate"
											name="dateOfBirth" #dateOfBirth = "ngModel"
											dateFormat="yy-mm-dd"></p-calendar>
								<div class="ui-g-12 validation-err" *ngIf="dateOfBirth.errors?.minlength">
									To pole jest wymagane.
								</div>
							</div>
						</div>

						<div class="ui-g-12">
							<div class="ui-g-4 ">Płeć:<span class="red">*</span></div>
							<div class="ui-g-8 ">
								<p-dropdown
										[options]="genders" [autoWidth]="false"
										placeholder="-" class="detail-view-input"
										[(ngModel)]="personalData.gender"
										name="gender" #gender = "ngModel"></p-dropdown>
							</div>
						</div>

						<div class="ui-g-12">
							<div class="ui-g-4 ">Imię ojca:</div>
							<div class="ui-g-8 ">
								<input type="text" pInputText
									   placeholder="-" class="detail-view-input"
									   [(ngModel)]="personalData.fathersName"
									   maxlength="25" pattern="[a-zA-ZęóąśłżźćńĘÓĄŚŁŻŹĆŃ]*"
									   name="fathersName" #fathersName = "ngModel">
								<div class="ui-g-12 validation-err" *ngIf="fathersName.errors?.pattern">
									Pole nie może zawierać cyfr i znaków białych.
								</div>
							</div>
						</div>

						<div class="ui-g-12">
							<div class="ui-g-4 ">Nazwisko rodowe:</div>
							<div class="ui-g-8 ">
								<input type="text" pInputText
									   placeholder="-" class="detail-view-input"
									   [(ngModel)]="personalData.familyName"
									   maxlength="35" pattern="[a-zA-ZęóąśłżźćńĘÓĄŚŁŻŹĆŃ]*"
									   name="familyName" #familyName = "ngModel">
								<div class="ui-g-12 validation-err" *ngIf="familyName.errors?.pattern">
									Pole nie może zawierać cyfr i znaków białych.
								</div>
							</div>
						</div>
					</div>
					<div class="ui-g-6 ui-sm-12">
						<div class="ui-g-12">
							<div class="ui-g-4 ">Nazwisko:<span class="red">*</span></div>
							<div class="ui-g-8 ">
								<input type="text" pInputText
									   placeholder="-" class="detail-view-input"
									   [(ngModel)]="personalData.surname"
									   maxlength="35" required
									   pattern="[a-zA-ZęóąśłżźćńĘÓĄŚŁŻŹĆŃ]*"
									   name="surname" #surname = "ngModel">
								<div class="ui-g-12 validation-err" *ngIf="surname.touched && surname.errors?.required">
									Pole nie może być puste
								</div>
								<div class="ui-g-12 validation-err" *ngIf="surname.errors?.pattern">
									Pole nie może zawierać cyfr i znaków białych.
								</div>
							</div>
						</div>

						<div class="ui-g-12">
							<div class="ui-g-4 ">PESEL:<span class="red">*</span></div>
							<div class="ui-g-8 ">
								<input type="text" pInputText
									   placeholder="-" class="detail-view-input"
									   maxlength="11" required
									   minlength="11"
									   pattern="[0-9]*"
									   [(ngModel)]="personalData.pesel"
									   name="pesel" #pesel = "ngModel">
								<div class="ui-g-12 validation-err" *ngIf="pesel.touched && pesel.errors?.required">
									Pole nie może być puste.
								</div>
								<div class="ui-g-12 validation-err" *ngIf="pesel.touched && pesel.errors?.minlength">
									Pesel jest niepoprawny.
								</div>
								<div class="ui-g-12 validation-err" *ngIf="pesel.errors?.pattern">
									Pole może zawierać tylko cyfry.
								</div>
							</div>
						</div>

						<div class="ui-g-12">
							<div class="ui-g-4 ">Miejsce urodzenia:<span class="red">*</span></div>
							<div class="ui-g-8 ">
								<input type="text" pInputText
									   placeholder="-" class="detail-view-input"
									   required maxlength="30"
									   pattern="[a-zA-ZęóąśłżźćńĘÓĄŚŁŻŹĆŃ\ ]*"
									   [(ngModel)]="personalData.placeOfBirth"
									   name="placeOfBirth" #placeOfBirth = "ngModel">
								<div class="ui-g-12 validation-err" *ngIf="placeOfBirth.touched && placeOfBirth.errors?.required">
									Pole nie może być puste
								</div>
								<div class="ui-g-12 validation-err" *ngIf="placeOfBirth.errors?.pattern">
									Pole nie może zawierać cyfr.
								</div>
							</div>
						</div>

						<div class="ui-g-12">
							<div class="ui-g-4 ">Narodowość:<span class="red">*</span></div>
							<div class="ui-g-8 ">
								<input type="text" pInputText
									   placeholder="-" class="detail-view-input"
									   [(ngModel)]="personalData.nationality"
									   required maxlength="45"
									   pattern="[a-zA-ZęóąśłżźćńĘÓĄŚŁŻŹĆŃ]*"
									   name="nationality" #nationality = "ngModel">
								<div class="ui-g-12 validation-err" *ngIf="nationality.touched && nationality.errors?.required">
									Pole nie może być puste
								</div>
								<div class="ui-g-12 validation-err" *ngIf="nationality.errors?.pattern">
									Pole nie może zawierać cyfr i znaków białych.
								</div>
							</div>
						</div>

						<div class="ui-g-12">
							<div class="ui-g-4 ">Imię matki:</div>
							<div class="ui-g-8 ">
								<input type="text" pInputText
									   placeholder="-" class="detail-view-input"
									   [(ngModel)]="personalData.mothersName"
									   maxlength="25" pattern="[a-zA-ZęóąśłżźćńĘÓĄŚŁŻŹĆŃ]*"
									   name="mothersName" #mothersName = "ngModel">
								<div class="ui-g-12 validation-err" *ngIf="mothersName.errors?.pattern">
									Pole nie może zawierać cyfr i znaków białych.
								</div>
							</div>
						</div>

						<div class="ui-g-12">
							<div class="ui-g-4 ">Nazwisko rodowe matki:</div>
							<div class="ui-g-8 ">
								<input type="text" pInputText
									   placeholder="-" class="detail-view-input"
									   [(ngModel)]="personalData.mothersMaidenName"
									   maxlength="25" pattern="[a-zA-ZęóąśłżźćńĘÓĄŚŁŻŹĆŃ]*"
									   name="mothersMaidenName" #mothersMaidenName = "ngModel">
								<div class="ui-g-12 validation-err" *ngIf="mothersMaidenName.errors?.pattern">
									Pole nie może zawierać cyfr i znaków białych.
								</div>
							</div>
						</div>
					</div>
				</div>
				<br/>
				<div class="ui-g-12">
					<button type="button" pButton icon="fa-check" [disabled]="personalDataForm.invalid || childForm.invalid || isCreating"
							(click)="saveData(child, personalData)" label="Dodaj"></button>
					<button type="button" pButton icon="fa-close"
							(click)="clearForm()" label="Wyczyść"></button>
					<i *ngIf="isCreating" class="fa fa-spinner fa-pulse fa fa-fw"></i>
				</div>
				<br/>
			</form>
			<br/>
		</div>
	</div>
</div>


